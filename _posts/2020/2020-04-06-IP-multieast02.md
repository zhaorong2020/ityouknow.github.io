---
layout: post
title: IP 多播之IGMP与多播路由选择协议
category: network-protocol
tags: [network-protocol]
excerpt: 一种节约网络资源的方式
---


##网际组管理协议IGMP

在上一篇博文中介绍了在互联网上实现IP多播需要两种协议：1、IGMP   2、多播路由协议

IGMP协议主要负责让连接在本地局域网上的多播路由知道本地局域网上是否有主机（准确说是某个进程）加入或离开了某一多播组。本文将详细介绍一下IGMP在多播实现中的具体操作。

从概念上讲，IGMP的工作可以分为两个阶段：
1、当某台主机加入新的多播组时，该主机应向多播组的多播地址发送一个IGMP报文，声称自己要成为该组的成员。本地多播路由器收到IGMP报文后，还要利用多播路由选择协议把这种组成员关系转发给互联网上其它多播路由

2、组成员是动态的。本地多播路由器要周期性的探寻本地局域网上的主机，以便知道这些主机是否还继续是组的成员。只要有一台主机对某个组响应那么多播路由就认为这个组是活跃的。但经过几次探寻后仍然没有主机回应，多播路由就认为本网络上的主机离开了这个组，因此也不把这个组的成员关系转发给其它多播路由

为了避免控制信息给网路增加开销，IGMP采用了具体的措施：

1. 主机和多播路由之间额所有通信使用IP多播

2. 多播路由器探寻组成员关系时，对所有组只发送一个探寻报文

3. 当局域网中存在多个多播路由器时，只选择其中一个探寻主机的成员关系

4. 主机收到询问时，会根据IGMP数据报中的数值N，在0到N之间随机选择一个延时时间，延时发送。若一台主机加入多个多播组，则延时时间最小的最先发送

5. 同一组中的每台主机都要监听响应，如果有主机响应的询问，自己就不在响应。

	
##多播路由选择协议

常见的多播路由选择协议有：

1. 距离向量多播路由选择协议DVMRP

2. 基于核心的转发树CBT

3. 开发最短通路优先的多播扩展MOSPF

4. 协议无关多播-稀疏方式PIM-SM

5. 协议无关多播-密集方式PIM-DM

以实现的多种使用的多播路由选择协议，他们在转发数据报时使用了一下三种协议：

（1）洪泛与剪除，该种方法适用于较小的多播组，而所有的组成员接入的局域网也是相邻的。该种方式开始路由器使用洪泛（广播）的方式转发多播数据报，然后使用反向路径广播RPB来避免兜圈。RPB的要点是：每个路由器收到IP多播数据报时都要检查数据报是否是从源点经最短路径传来的，如果不是就丢弃不进行转发。最终得到一个以源点为根节点的多播转发树。如果多播路由器发现其下游树枝已经没有主机加入该多播组，就将自己和下游树枝一起减掉。

（2）隧道技术：隧道技术适合用于多播组的位置在地理位置上很分散的情况。网一（多播路由R1）、网二（多播路由R2）支持多播，但是R1，R2之间的网络不支持多播。为此，R1就会对多播数据报进行再次封装以单播的方式传给R2，R2收到后拆除头部再以多播形式进行转发

（3）基于核心的发现技术：这种方法对于多播组大小在较大范围内变化时都适用。这种方法对于每个多播组G都指定一个核心路由器，给出它的单播地址，核心路由器按照前面的方法构造出基于多播组G的转发树。
	
	
	
 
	




