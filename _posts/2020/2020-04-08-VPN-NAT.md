---
layout: post
title: VPN与NAT
category: network-protocol
tags: [network-protocol]
excerpt: IPV4地址不够用怎么办？
---


IPV4地址不够用这个问题相信大家都不陌生，为了解决这个问题世界上的网络大神们想了很多种办法，
IPV6是其中一种，而这篇文章也介绍了一种方式专用网络与网络地址转换技术

我们知道在一些机构或者公司他们拥有很多主机，这些主机只在本机构或公司内部使用，因此只需要
分配给这些主机在本机构内有效的IP地址即可而不需要分配给他们全球唯一的IP地址。

RFC1819指明了一些专用地址用于这些机构内部使用。在互联网上的路由器对于目的地址是专用地址的
报文一律不会进行转发。三块专用地址为：
10.0.0.0到10.255.255.255
172.16.0.0到172.31.255.255
192.168.0.0到192.168.255.255
使用专用地址的网络称为专用网


##一、虚拟专用网络VPN
我们知道有时候一些机构有很多部门而这些部门又分布很广，可是部门之间需要通信啊！解决这个问题的
方法有两种：1、租用电信公司的通信线路，这种方法租金很高  2、利用公用的互联网作为本机构各专用
网络的通信载体，这种网络就是虚拟专用网络VPN

![](https://zhaorong2020.github.io/assets/images/2020/net-protocol/vpn.png)

如上图所示，广州分部的10.168.1.4（后面称主机A）在向上海分部的10.168.2.2（后面称主机B）发送数据时。数据先到达路由器10.168.1.1（后面称R1），R1发现数据报的目的网络必须经过互联网才可以到达，于是就将整个报文加密作为数据部分，重新封装数据包源地址为：202.96.283.77（全球IP），目的地址：114.80.166.240（全球IP）。数据报从R1到达R2（10.168.2.1）后拆掉数据报头部，然后解密再将解密后的数据在专用网络中传输。

像上面这种两个网络属于同一机构的专用虚拟网络叫做内联网
有时一个机构的VPN需要外部网络接入（如合作伙伴）这种网络叫做外联网
还有一种远程VPN接入，例如：在外地的员工通过拨号是自己的主机接入互联网，通过安转载主机上的VPN软件与公司主机之间建立VPN隧道，远程公司主机来工作，此时外地员工与公司主机之间的通信也是加密的。
